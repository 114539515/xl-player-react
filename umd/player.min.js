!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("react-dom"),require("flv.lm.js"),require("hls.js")):"function"==typeof define&&define.amd?define(["exports","react","react-dom","flv.lm.js","hls.js"],t):t((e=e||self).LMPlayer={},e.React,e.ReactDOM,e.flvjs,e.Hls)}(this,function(e,m,o,l,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){return(n="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)})(e)}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}m=m&&m.hasOwnProperty("default")?m.default:m,o=o&&o.hasOwnProperty("default")?o.default:o,l=l&&l.hasOwnProperty("default")?l.default:l;var h=function(){function t(e){s(this,t),this.video=e,this.events={},this.playerEvents={}}return u(t,[{key:"on",value:function(e,t){this.events&&this.events[e]?this.events[e].listener.push(t):this.events[e]={type:e,listener:[t]}}},{key:"addEventListener",value:function(e,t){this.video&&(this.playerEvents[e]?this.playerEvents[e].push(t):this.playerEvents[e]=[t],this.video.addEventListener(e,t,!1))}},{key:"removeEventListener",value:function(e,t){if(this.video){if(!this.playerEvents||!this.playerEvents[e])return;var n=this.playerEvents[e].findIndex(function(e){return e===t});-1<n&&this.playerEvents[e].splice(n,1),this.video.removeEventListener(e,t,!1)}}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.events&&this.events[e]&&this.events[e].listener.forEach(function(e){e.apply(void 0,n)})}},{key:"off",value:function(e,t){if(this.events&&this.events.eventName){var n=this.events[e].listener.findIndex(function(e){return e===t});-1<n&&this.events[e].listener.splice(n,1)}}},{key:"destroy",value:function(){var n=this;Object.keys(this.playerEvents).forEach(function(t){n.playerEvents[t].forEach(function(e){n.removeEventListener(t,e)})}),this.playerEvents={},this.events={}}}]),t}();function f(e,t){if(i.isSupported()){var n=new i({liveDurationInfinity:!0,levelLoadingTimeOut:15e3,fragLoadingTimeOut:25e3,enableWorker:!0});return n.loadSource(t),n.attachMedia(e),n}}function v(e,t){var n=t.flvOptions,r=void 0===n?{}:n,i=t.flvConfig,a=void 0===i?{}:i;if(l.isSupported()){var o=l.createPlayer(Object.assign({},r,{type:"flv",url:t.file}),Object.assign({},a,{enableWorker:!0,enableStashBuffer:!1,stashInitialSize:128,isLive:t.isLive||!0}));return o.attachMediaElement(e),o.load(),o}}function y(e){var t=new URL(e),n="".concat(t.origin).concat(t.pathname),r=/([^\.\/\\]+)\.(([a-z]|[0-9])+(\?\S+)?)$/i.exec(n);if(!r)return-1<e.indexOf(".flv")?"flv":"hls";var i=r[2].replace(r[4],"");return i||(-1<e.indexOf(".flv")?"flv":"hls")}function g(e){return e&&(document.fullscreenElement===e||document.msFullscreenElement===e||document.mozFullScreenElement===e||document.webkitFullscreenElement===e)||!1}function E(e,t){var n=e?"addEventListener":"removeEventListener";["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"].map(function(e){return document[n](e,t)})}function C(e,t,n){var r,i,a=t,o=e.getBoundingClientRect(),l=o.width,s=o.height;if(1===n)return[0,0];r=l*(n-1)/2/n,i=s*(n-1)/2/n;var u=0,c=0;return 0<=a[0]&&a[0]>r&&(u=r),0<=a[0]&&a[0]<r&&(u=a[0]),a[0]<0&&a[0]<-r&&(u=-r),a[0]<0&&a[0]>-r&&(u=a[0]),0<=a[1]&&a[1]>i&&(c=i),0<=a[1]&&a[1]<i&&(c=a[1]),a[1]<0&&a[1]<-i&&(c=-i),a[1]<0&&a[1]>-i&&(c=a[1]),u!==a[0]||c!==a[1]?[u,c]:void 0}function P(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],0<=t.indexOf(n)||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var L=m.createContext(null),b=L.Provider,k=L.Consumer;function R(r){var n=function(){function e(){return s(this,e),c(this,d(e).apply(this,arguments))}return p(e,m.Component),u(e,[{key:"render",value:function(){var e=this.props,t=e.forwardRef,n=P(e,["forwardRef"]);return m.createElement(k,null,function(e){return m.createElement(r,Object.assign({},n,e,{ref:t}))})}}]),e}();return m.forwardRef(function(e,t){return m.createElement(n,Object.assign({},e,{forwardRef:t}))})}function S(e){var t=e.type,n=e.className,r=void 0===n?"":n,i=P(e,["type","className"]);return m.createElement("i",Object.assign({className:"lm-player-iconfont ".concat(t," ").concat(r)},i))}var T=function(){function t(e){var l;return s(this,t),(l=c(this,d(t).call(this,e))).renderSliderTips=function(o){l.props.renderTips&&(clearTimeout(l.timer),l.timer=setTimeout(function(){var e=l.layoutDom.getBoundingClientRect(),t=e.x,n=e.width,r=e.top,i=o.pageX,a=(o.pageX-t)/n;a=a<0?0:1<a?1:a,l.setState({tipsX:i,tipsY:r,showTips:!0,tempValue:a})},200))},l.hideSliderTips=function(){clearTimeout(l.timer),l.setState({showTips:!1})},l.cancelPropagation=function(e){e.stopPropagation()},l.startDrag=function(e){e.stopPropagation(),l.dragFlag=!0,document.body.addEventListener("mousemove",l.moveChange),document.body.addEventListener("mouseup",l.stopDrag)},l.moveChange=function(e){e.stopPropagation();var t=l.computedPositionForEvent(e);l.setState({value:t})},l.stopDrag=function(e){e.stopPropagation(),document.body.removeEventListener("mousemove",l.moveChange),document.body.removeEventListener("mouseup",l.stopDrag),l.dragFlag=!1;var t=l.state.value/100;t=t<0?0:1<t?1:t,l.props.onChange&&l.props.onChange(t)},l.changeCurrentValue=function(e){e.stopPropagation();var t=l.layoutDom.getBoundingClientRect(),n=t.width,r=t.x,i=(e.pageX-r)/n;l.props.onChange&&l.props.onChange(i)},l.sliderDomRef=m.createRef(),l.layoutDom=null,l.lineDom=null,l.dragDom=null,l.dragFlag=!1,l.state={value:l.props.currentPercent||0,tempValue:0,showTips:!1,tipsX:0,tipsY:0},l}return p(t,m.Component),u(t,[{key:"componentWillReceiveProps",value:function(e){this.dragFlag||this.setState({value:e.currentPercent||0})}},{key:"componentDidMount",value:function(){this.layoutDom=o.findDOMNode(this.sliderDomRef.current),this.dragDom=this.layoutDom.querySelector(".drag-change-icon"),this.lineDom=this.layoutDom.querySelector(".slider-content"),this.layoutDom.addEventListener("mousemove",this.renderSliderTips,!1),this.layoutDom.addEventListener("mouseout",this.hideSliderTips,!1),this.lineDom.addEventListener("click",this.changeCurrentValue,!1),this.dragDom.addEventListener("click",this.cancelPropagation,!1),this.dragDom.addEventListener("mousedown",this.startDrag,!1)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.layoutDom.removeEventListener("mousemove",this.renderSliderTips,!1),this.layoutDom.removeEventListener("mouseout",this.hideSliderTips,!1),this.lineDom.removeEventListener("click",this.changeCurrentValue,!1),this.dragDom.removeEventListener("click",this.cancelPropagation,!1),this.dragDom.removeEventListener("mousedown",this.startDrag,!1),document.body.removeEventListener("mousemove",this.moveChange),document.body.removeEventListener("mouseup",this.stopDrag),this.sliderDomRef=null,this.layoutDom=null,this.lineDom=null,this.dragDom=null,this.dragFlag=null}},{key:"computedPositionForEvent",value:function(e){var t=this.layoutDom.getBoundingClientRect(),n=t.x,r=t.width,i=e.pageX-n;return r<i&&(i=r),i<0&&(i=0),i/r*100}},{key:"render",value:function(){var e=this.state,t=e.value,n=e.showTips,r=e.tipsX,i=e.tipsY,a=this.props,o=a.availablePercent,l=void 0===o?0:o,s=a.className,u=void 0===s?"":s;return m.createElement("div",{className:"slider-layout ".concat(u),ref:this.sliderDomRef},m.createElement("div",{className:"slider-content"},m.createElement("div",{className:"slider-max-line"}),m.createElement("div",{className:"slider-visibel-line",style:{width:"".concat(l,"%")}}),m.createElement("div",{className:"slider-current-line",style:{width:"".concat(t,"%")}}),this.props.children),m.createElement("div",{className:"slider-other-content"},m.createElement("div",{className:"drag-change-icon",draggable:!1,style:{left:"".concat(t,"%")}})),m.createElement(D,{visibel:n,className:"lm-player-slide-tips",style:{left:r,top:i}},this.props.renderTips&&this.props.renderTips(this.state.tempValue)))}}]),t}(),D=function(){function n(e){var t;return s(this,n),(t=c(this,d(n).call(this,e))).ele=document.createElement("div"),t}return p(n,m.Component),u(n,[{key:"componentDidMount",value:function(){document.body.appendChild(this.ele)}},{key:"componentWillUnmount",value:function(){document.body.removeChild(this.ele),this.ele=null}},{key:"render",value:function(){var e=this.props,t=e.visibel,n=e.children,r=e.style,i=e.className,a=void 0===i?"":i;return o.createPortal(t?m.createElement("div",{className:a,style:r},n):null,this.ele)}}]),n}();function O(e){var t=e.visibel,n=void 0===t||t,r=e.className,i=void 0===r?"":r,a=e.children,o=P(e,["visibel","className","children"]);return!1===n?null:m.createElement("span",Object.assign({className:"contraller-bar-item ".concat(i)},o),a)}function w(){return m.createElement("div",{className:"lm-player-message-mask lm-player-mask-loading-animation"},m.createElement(S,{style:{fontSize:80},type:"lm-player-PlaySource",title:"请选择视频源"}))}var I,N,_,A,x,F,M,H={RELOAD:"reload",RELOAD_FAIL:"reloadFail",RELOAD_SUCCESS:"reloadSuccess",ERROR:"error",ERROR_RELOAD:"errorRload",HISTORY_PLAY_END:"historyPlayEnd",SEEK:"seek",TRANSFORM:"transform",CHANGE_PLAY_INDEX:"changePlayIndex",HIDE_CONTRALLER:"hideContraller",SHOW_CONTRALLER:"showContraller",CLEAR_ERROR_TIMER:"clearErrorTimer"},W=R(I=function(){function t(e){var i;return s(this,t),(i=c(this,d(t).call(this,e))).seek=function(){i.historyEnd=!1},i.historyPlayEnd=function(){i.historyEnd=!0},i.updateRender=function(){i.mounted&&i.forceUpdate()},i.changePlayStatus=function(){var e=i.props,t=e.api,n=e.video;i.historyEnd?i.props.reloadHistory():n.paused?t.play():t.pause()},i.mutedChange=function(){var e=i.props,t=e.api;e.video.muted?t.unmute():t.mute()},i.volumechange=function(){i.forceUpdate()},i.openSliderVolume=function(){i.setState({openSliderVolume:!0})},i.closeSliderVolume=function(){i.setState({openSliderVolume:!1})},i.onChangeVolume=function(e){var t=i.props,n=t.api,r=t.video;n.setVolume(parseFloat(e.toFixed(1))),0<e&&r.muted&&n.unmute()},i.reload=function(){i.props.isHistory?i.props.reloadHistory():i.props.api.reload(),i.props.event.emit(H.CLEAR_ERROR_TIMER)},i.state={openSliderVolume:!1},i.historyEnd=!1,i.mounted=!1,i}return p(t,m.Component),u(t,[{key:"componentDidMount",value:function(){var e=this.props.event;this.mounted=!0,e.addEventListener("play",this.updateRender),e.addEventListener("pause",this.updateRender),e.addEventListener("volumechange",this.volumechange),e.on(H.HISTORY_PLAY_END,this.historyPlayEnd),e.on(H.SEEK,this.seek)}},{key:"render",value:function(){var e=this.state.openSliderVolume,t=this.props,n=t.video,r=t.playerProps,i=r.isLive,a=r.leftExtContents,o=void 0===a?null:a,l=r.leftMidExtContents,s=void 0===l?null:l,u=1===n.volume?"lm-player-volume-max":"lm-player-volume-normal-fuben";return m.createElement("div",{className:"contraller-left-bar"},o,m.createElement(O,{visibel:!i},m.createElement(S,{onClick:this.changePlayStatus,type:n.paused?"lm-player-Play_Main":"lm-player-Pause_Main",title:n.paused?"播放":"暂停"})),m.createElement(O,{className:"contraller-bar-volume ".concat(e?"contraller-bar-hover-volume":""),onMouseOver:this.openSliderVolume,onMouseOut:this.closeSliderVolume},m.createElement(S,{onClick:this.mutedChange,type:n.muted?"lm-player-volume-close":u,title:"音量"}),m.createElement("div",{className:"volume-slider-layout"},m.createElement(T,{className:"volume-slider",currentPercent:n.muted?0:100*n.volume,onChange:this.onChangeVolume,renderTips:function(e){return m.createElement("span",null,Math.round(100*e),"%")}}))),m.createElement(O,null,m.createElement(S,{onClick:this.reload,type:"lm-player-Refresh_Main",title:"重载"})),s)}}]),t}())||I,j=R(N=function(){function a(){var e,i;s(this,a);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(i=c(this,(e=d(a)).call.apply(e,[this].concat(n)))).update=function(){i.forceUpdate()},i.fullscreen=function(){var e=i.props,t=e.api;g(e.playContainer)?t.cancelFullScreen():t.requestFullScreen(),i.forceUpdate()},i.setScale=function(){var e=i.props,t=e.api,n=e.playContainer.querySelector(".player-mask-layout");t.setScale.apply(t,arguments);var r=C(n,t.getPosition(),t.getScale());r&&t.setPosition(r,!0)},i.snapshot=function(){var e=i.props,t=e.api,n=e.playerProps;n.snapshot&&n.snapshot(t.snapshot())},i}return p(a,m.Component),u(a,[{key:"componentDidMount",value:function(){E(!0,this.update)}},{key:"componentWillUnmount",value:function(){E(!1,this.update)}},{key:"render",value:function(){var e=this,t=this.props,n=t.playContainer,r=t.playerProps,i=r.isScale,a=r.snapshot,o=r.rightExtContents,l=void 0===o?null:o,s=r.rightMidExtContents,u=void 0===s?null:s,c=g(n);return m.createElement("div",{className:"contraller-right-bar"},u,i&&m.createElement(m.Fragment,null,m.createElement(O,null,m.createElement(S,{title:"缩小",onClick:function(){return e.setScale(-.2)},type:"lm-player-ZoomOut_Main"})),m.createElement(O,null,m.createElement(S,{title:"复位",onClick:function(){return e.setScale(1,!0)},type:"lm-player-ZoomDefault_Main"})),m.createElement(O,null,m.createElement(S,{title:"放大",onClick:function(){return e.setScale(.2)},type:"lm-player-ZoomIn_Main"}))),a&&m.createElement(O,null,m.createElement(S,{title:"截图",onClick:this.snapshot,type:"lm-player-SearchBox"})),m.createElement(O,null,m.createElement(S,{title:c?"窗口":"全屏",onClick:this.fullscreen,type:c?"lm-player-ExitFull_Main":"lm-player-Full_Main"})),l)}}]),a}())||N,B=R(_=function(){function n(e){var t;return s(this,n),(t=c(this,d(n).call(this,e))).hideContraller=function(){t.setState({hideBar:!0})},t.showContraller=function(){t.setState({hideBar:!1})},t.state={hideBar:!1},t}return p(n,m.Component),u(n,[{key:"componentDidMount",value:function(){var e=this.props.event;e.on(H.HIDE_CONTRALLER,this.hideContraller),e.on(H.SHOW_CONTRALLER,this.showContraller)}},{key:"render",value:function(){return m.createElement("div",{className:"contraller-bar-layout ".concat(this.state.hideBar?"hide-contraller-bar":"")},m.createElement(W,null),m.createElement(j,null))}}]),n}())||_,U=R(A=function(){function n(e){var t;return s(this,n),(t=c(this,d(n).call(this,e))).showContraller=function(){t.props.event.emit(H.SHOW_CONTRALLER),t.hideContraller()},t.hideContraller=function(){var e=t.props.event;clearTimeout(t.timer),t.timer=setTimeout(function(){e.emit(H.HIDE_CONTRALLER)},3e3)},t.timer=null,t}return p(n,m.Component),u(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.playContainer,n=e.event;t.addEventListener("mousemove",this.showContraller,!1),t.addEventListener("mouseout",this.hideContraller,!1),this.timer=setTimeout(function(){n.emit(H.HIDE_CONTRALLER)},5e3)}},{key:"componentWillUnmount",value:function(){var e=this.props.playContainer;e.addEventListener("mousemove",this.showContraller,!1),e.addEventListener("mouseout",this.hideContraller,!1),clearTimeout(this.timer)}},{key:"render",value:function(){return null}}]),n}())||A,q=R(x=function(){function n(e){var t;return s(this,n),(t=c(this,d(n).call(this,e))).clearReloadMessage=function(){t.message=null,t.mounted&&t.forceUpdate()},t.reload=function(){t.setState({status:"reload"})},t.errorReload=function(e){t.message=m.createElement("div",null,"视频加载错误，正在进行重连第",e,"重连"),t.mounted&&t.setState({status:"reload",loading:!0})},t.reloadFail=function(){t.message=m.createElement("div",null,"视频错误"),t.mounted&&t.setState({status:"fail"})},t.reloadSuccess=function(){t.message=null,t.mounted&&t.setState({status:null})},t.openLoading=function(){t.mounted&&t.setState({loading:!0})},t.closeLoading=function(){t.mounted&&t.setState({loading:!1})},t.historyPlayEnd=function(){t.message=null,t.mounted&&t.setState({status:null,loading:!1}),t.props.api.pause()},t.state={loading:!1,status:null},t.mounted=!1,t.message=null,t}return p(n,m.Component),u(n,[{key:"componentDidMount",value:function(){var e=this.props.event;this.mounted=!0,e.addEventListener("loadstart",this.openLoading),e.addEventListener("waiting",this.openLoading),e.addEventListener("seeking",this.openLoading),e.addEventListener("loadeddata",this.closeLoading),e.addEventListener("canplay",this.closeLoading),e.on(H.ERROR_RELOAD,this.errorReload),e.on(H.RELOAD_FAIL,this.reloadFail),e.on(H.RELOAD_SUCCESS,this.reloadSuccess),e.on(H.RELOAD,this.reload),e.on(H.HISTORY_PLAY_END,this.historyPlayEnd),e.on(H.CLEAR_ERROR_TIMER,this.clearReloadMessage)}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.status;return m.createElement("div",{className:"lm-player-message-mask ".concat(t||"fail"===n?"lm-player-mask-loading-animation":"")},m.createElement(S,{type:"fail"===n?"lm-player-YesorNo_No_Dark":"lm-player-Loading",className:"".concat(t&&"fail"!==n?"lm-player-loading-animation":"fail"===n?"lm-player-loadfail":""," lm-player-loading-icon")}),m.createElement("span",{className:"lm-player-message"},this.message))}}]),n}())||x,V=R(F=function(){function t(e){var r;return s(this,t),(r=c(this,d(t).call(this,e))).hideContraller=function(){r.setState({hideBar:!0})},r.showContraller=function(){r.setState({hideBar:!1})},r.getDuration=function(){var e=r.props.api;r.setState({duration:e.getDuration()})},r.getCurrentTime=function(){var e=r.props.api,t={currentTime:e.getCurrentTime(),buffered:e.getSecondsLoaded()};t.buffered===r.state.buffered&&delete t.buffered,r.setState(t)},r.getBuffered=function(){var e=r.props.api;r.setState({buffered:e.getSecondsLoaded()})},r.changePlayTime=function(e){var t=r.props.api,n=e*r.state.duration;t.pause(),r.setState({currentTime:n}),t.seekTo(n)},r.seekendPlay=function(){var e=r.props;e.video;e.api.play()},r.renderTimeLineTips=function(e){var t=function(e){var t=Math.ceil(e);if(60<t){var n=Math.ceil(e%60),r=Math.floor(e/60);if(t="".concat(r<10?"0".concat(r):r,":").concat(n<10?"0".concat(n):n),60<r){r=Math.ceil(e/60%60);var i=Math.floor(e/60/60);t="".concat(i<10?"0".concat(i):i,":").concat(r<10?"0".concat(r):r,":").concat(n<10?"0".concat(n):n)}else t="00:".concat(t)}else t="00:00:".concat(t<10?"0".concat(t):t);return t}(e*r.state.duration);return m.createElement("span",null,t)},r.fastForward=function(){r.props.api.fastForward()},r.backWind=function(){r.props.api.backWind()},r.state={duration:0,currentTime:0,buffered:0,hideBar:!1},r}return p(t,m.Component),u(t,[{key:"componentDidMount",value:function(){var e=this.props.event;e.addEventListener("loadedmetadata",this.getDuration),e.addEventListener("durationchange",this.getDuration),e.addEventListener("timeupdate",this.getCurrentTime),e.addEventListener("progress",this.getBuffered),e.addEventListener("suspend",this.getBuffered),e.addEventListener("seeked",this.seekendPlay),e.on(H.HIDE_CONTRALLER,this.hideContraller),e.on(H.SHOW_CONTRALLER,this.showContraller)}},{key:"render",value:function(){var e=this.state,t=e.duration,n=e.currentTime,r=e.buffered,i=e.hideBar,a=Math.round(n/t*100),o=Math.round(r/t*100);return m.createElement("div",{className:"video-time-line-layout ".concat(i?"hide-time-line":"")},m.createElement(S,{type:"lm-player-PrevFast",onClick:this.backWind,className:"time-line-action-item"}),m.createElement(T,{className:"time-line-box",currentPercent:a,availablePercent:o,onChange:this.changePlayTime,renderTips:this.renderTimeLineTips}),m.createElement(S,{type:"lm-player-NextFast_Light",onClick:this.fastForward,className:"time-line-action-item"}))}}]),t}())||F;function Y(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var z,X=R(M=function(){function t(e){var p;return s(this,t),(p=c(this,d(t).call(this,e))).clearErrorTimer=function(){p.errorTimer=0,clearTimeout(p.reconnectTimer)},p.clearError=function(){var e=p.props.event;0<p.errorTimer&&(console.warn("视频重连成功！"),e.emit(H.RELOAD_SUCCESS),p.clearErrorTimer())},p.errorHandle=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).error.apply(e,n),clearTimeout(p.reconnectTimer);var i=p.props,a=i.event,o=i.api,l=i.isHistory,s=i.changePlayIndex,u=i.playIndex,c=i.playerProps,d=p.errorTimer+1;a.emit.apply(a,[H.ERROR].concat(n)),d>c.errorReloadTimer?(l?s(u+1):a.emit(H.RELOAD_FAIL),o.unload()):(p.errorTimer=d,(n[1]&&n[1].loader||n[0].indexOf&&-1<n[0].indexOf("NetworkError"))&&p.reloadAction(d,n),p.reconnectTimer=setTimeout(function(){p.reloadAction(d,n)},2e4))},p.reloadAction=function(e,t){var n=p.props,r=n.event,i=n.api,a=n.hlsPlayer;r.emit.apply(r,[H.ERROR_RELOAD,e].concat(Y(t))),console.warn("视频播放出错，正在进行重连".concat(e)),a&&(a.swapAudioCodec(),a.recoverMediaError()),i.reload()},p.errorTimer=0,p}return p(t,m.Component),u(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.event,n=e.flvPlayer,r=e.hlsPlayer;n&&n.on(l.Events.ERROR,this.errorHandle),r&&r.on(i.Events.ERROR,this.errorHandle),t.addEventListener("error",this.errorHandle,!1),t.addEventListener("canplay",this.clearError,!1),t.on(H.CHANGE_PLAY_INDEX,this.clearErrorTimer),t.on(H.CLEAR_ERROR_TIMER,this.clearErrorTimer)}},{key:"componentWillReceiveProps",value:function(e){e.flvPlayer&&e.flvPlayer!==this.props.flvPlayer&&e.flvPlayer.on(l.Events.ERROR,this.errorHandle),e.hlsPlayer&&e.hlsPlayer!==this.props.hlsPlayer&&e.hlsPlayer.on(i.Events.ERROR,this.errorHandle)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.reconnectTimer)}},{key:"render",value:function(){return null}}]),t}())||M,K=R(z=function(){function n(e){var i;s(this,n),(i=c(this,d(n).call(this,e))).openDrag=function(e){i.position.start=[e.pageX,e.pageY],i.dragDom.addEventListener("mousemove",i.moveChange),i.dragDom.addEventListener("mouseup",i.stopDrag)},i.moveChange=function(e){var t=i.props.api,n=t.getPosition();i.position.end=[e.pageX,e.pageY];var r=[n[0]+(i.position.end[0]-i.position.start[0]),n[1]+(i.position.end[1]-i.position.start[1])];t.setPosition(r),i.position.start=[e.pageX,e.pageY]},i.stopDrag=function(){i.dragDom.removeEventListener("mousemove",i.moveChange),i.dragDom.removeEventListener("mouseup",i.stopDrag),i.transformChange()},i.transformChange=function(){var e=i.props.api,t=C(i.dragDom,e.getPosition(),e.getScale());t&&e.setPosition(t,!0)};var t=e.playContainer;return i.dragDom=t.querySelector(".player-mask-layout"),i.position={start:[0,0],end:[0,0]},i}return p(n,m.Component),u(n,[{key:"componentDidMount",value:function(){this.props.playerProps.isDraggable&&(this.dragDom.addEventListener("mousedown",this.openDrag),this.props.event.addEventListener("transform",this.transformChange,!0))}},{key:"componentWillUnmount",value:function(){this.dragDom.removeEventListener("mousedown",this.openDrag)}},{key:"render",value:function(){return null}}]),n}())||z,G=function(){function a(e,t,n,r,i){s(this,a),this.player=e,this.playContainer=t,this.flv=r,this.hls=i,this.event=n,this.scale=1,this.position=[0,0]}return u(a,[{key:"updateChunk",value:function(e){var t=e.flv,n=e.hls;this.flv=t,this.hls=n}},{key:"requestFullScreen",value:function(){g(this.playContainer)||function(e){e.requestFullScreen?e.requestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()}(this.playContainer)}},{key:"cancelFullScreen",value:function(){g(this.playContainer)&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())}},{key:"play",value:function(){this.player.paused&&this.player.play()}},{key:"pause",value:function(){this.player.paused||this.player.pause()}},{key:"destroy",value:function(){this.player.removeAttribute("src"),this.unload(),this.flv&&this.flv.destroy(),this.hls&&this.hls.destroy(),this.scale=null,this.position=null}},{key:"seekTo",value:function(e,t){var n=this.getBufferedTime();this.flv&&n[0]>e&&(this.flv.unload(),this.flv.load()),this.player.currentTime=e,t||this.event.emit(H.SEEK,e)}},{key:"reload",value:function(){this.unload(),this.load(),this.play(),this.event.emit(H.RELOAD),0!==this.getCurrentTime&&this.seekTo(0)}},{key:"unload",value:function(){this.flv&&this.flv.unload(),this.hls&&this.hls.stopLoad()}},{key:"load",value:function(){if(this.flv&&this.flv.load(),this.hls){try{this.hls.swapAudioCodec(),this.hls.recoverMediaError()}catch(e){}this.hls.startLoad()}}},{key:"setVolume",value:function(e){this.player.volume=e}},{key:"mute",value:function(){this.player.muted=!0}},{key:"unmute",value:function(){this.player.muted=!1}},{key:"requestPictureInPicture",value:function(){this.player.requestPictureInPicture&&document.pictureInPictureElement!==this.player&&this.player.requestPictureInPicture()}},{key:"exitPictureInPicture",value:function(){document.exitPictureInPicture&&document.pictureInPictureElement===this.player&&document.exitPictureInPicture()}},{key:"setPlaybackRate",value:function(e){this.player.playbackRate=e}},{key:"getDuration",value:function(){if(!this.player)return null;var e=this.player,t=e.duration,n=e.seekable;return t===1/0&&0<n.length?n.end(n.length-1):t}},{key:"getCurrentTime",value:function(){return this.player?this.player.currentTime:null}},{key:"getSecondsLoaded",value:function(){return this.getBufferedTime()[1]}},{key:"getBufferedTime",value:function(){if(!this.player)return null;var e=this.player.buffered;if(0===e.length)return[0,0];var t=e.end(e.length-1),n=e.start(e.length-1),r=this.getDuration();return r<t?r:[n,t]}},{key:"fastForward",value:function(e){var t=0<arguments.length&&void 0!==e?e:5,n=this.getDuration(),r=this.getCurrentTime()+t;this.seekTo(n-1<r?n-1:r)}},{key:"backWind",value:function(e){var t=0<arguments.length&&void 0!==e?e:5,n=this.getCurrentTime()-t;this.seekTo(n<1?1:n)}},{key:"snapshot",value:function(){var e=document.createElement("canvas"),t=e.getContext("2d");return e.width=this.player.videoWidth,e.height=this.player.videoHeight,t.drawImage(this.player,0,0,e.width,e.height),setTimeout(function(){e.remove(),t=e=null},200),e.toDataURL()}},{key:"setScale",value:function(e,t){var n=this,r=1<arguments.length&&void 0!==t&&t,i=this.scale+e;r?i=e:(i<1&&(i=1),3<i&&(i=3)),this.scale=i,this.player.style.transition="transform 0.3s",this.__setTransform(),this.event.emit(H.TRANSFORM),setTimeout(function(){n.player.style.transition="unset"},500)}},{key:"getScale",value:function(){return this.scale}},{key:"setPosition",value:function(e,t){this.position=e,this.player.style.transition=t?"transform 0.3s":"unset",this.__setTransform()}},{key:"getPosition",value:function(){return this.position}},{key:"__setTransform",value:function(){this.player.style.transform="scale(".concat(this.scale,") translate(").concat(this.position[0],"px,").concat(this.position[1],"px)")}},{key:"getApi",value:function(){return{play:this.play.bind(this),reload:this.reload.bind(this),pause:this.pause.bind(this),seekTo:this.seekTo.bind(this),setVolume:this.setVolume.bind(this),mute:this.mute.bind(this),unmute:this.unmute.bind(this),requestPictureInPicture:this.requestPictureInPicture.bind(this),exitPictureInPicture:this.exitPictureInPicture.bind(this),setPlaybackRate:this.setPlaybackRate.bind(this),destroy:this.destroy.bind(this),getDuration:this.getDuration.bind(this),getCurrentTime:this.getCurrentTime.bind(this),getSecondsLoaded:this.getSecondsLoaded.bind(this),getBufferedTime:this.getBufferedTime.bind(this),fastForward:this.fastForward.bind(this),backWind:this.backWind.bind(this),snapshot:this.snapshot.bind(this),requestFullScreen:this.requestFullScreen.bind(this),cancelFullScreen:this.cancelFullScreen.bind(this),__player:this.player,flv:this.flv,hls:this.hls}}}]),a}();function Z(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}var $,J,Q={addEventListener:function(e){var t=Z().replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(t,e,!1)},removeEventListener:function(e){var t=Z().replace(/[H|h]idden/,"")+"visibilitychange";document.removeEventListener(t,e,!1)},visibilityState:function(){return document[function(){var e=["webkit","moz","ms","o"];if("visibilityState"in document)return"visibilityState";for(var t=0;t<e.length;t++)if(e[t]+"VisibilityState"in document)return e[t]+"VisibilityState";return null}()]}},ee=R($=function(){function t(e){var r;return s(this,t),(r=c(this,d(t).call(this,e))).browserTabChange=function(){"visible"===Q.visibilityState()&&r.focusSeekAction()},r.canplay=function(){var e=r.props.api;r.isCanPlay=!0,e.play()},r.focusSeekAction=function(){var e=r.props.api,t=e.getCurrentTime(),n=e.getSecondsLoaded();5<n-t&&(console.warn("当前延时过大current->".concat(t," buffered->").concat(n,", 基于视频当前缓存时间更新当前播放时间 updateTime -> ").concat(n-2)),e.seekTo(0<n-2?n-2:0))},r.timer=null,r.isCanPlay=!1,r}return p(t,m.Component),u(t,[{key:"componentDidMount",value:function(){var e=this.props.event;Q.addEventListener(this.browserTabChange),e.addEventListener("canplay",this.canplay)}},{key:"componentWillUnmount",value:function(){this.props.event;Q.removeEventListener(this.browserTabChange)}},{key:"render",value:function(){return null}}]),t}())||$,te=function(){function t(e){var n;return s(this,t),(n=c(this,d(t).call(this,e))).initPlayer=function(){if(!n.props.file)return!1;var e=y(n.props.file);return"flv"===e||"flv"===n.props.type?n.flv=v(n.player,n.props):"m3u8"===e||"hls"===n.props.type?n.hls=f(n.player,n.props.file):n.player.src=n.props.file,!0},n.renderVideoTools=function(){return n.api?m.createElement(m.Fragment,null,m.createElement(B,null),m.createElement(q,null),m.createElement(K,null),m.createElement(U,null),m.createElement(X,{flvPlayer:n.flv,hlsPlayer:n.hls}),n.props.isLive?m.createElement(ee,{key:n.props.file}):m.createElement(V,null)):m.createElement(w,null)},n.getPlayUrl=function(){return n.props.file},n.getPlayerApiContext=function(){var e=n.api?n.api.getApi():{},t=n.event?{on:n.event.on.bind(n.event),off:n.event.off.bind(n.event),emit:n.event.emit.bind(n.event)}:{};return Object.assign({},e,t,{getPlayUrl:n.getPlayUrl,playContainer:n.playContainer})},n.getProvider=function(){return{video:n.player,event:n.event,playerProps:n.props,api:n.api,playContainer:n.playContainer}},n.player=null,n.event=null,n.flv=null,n.hls=null,n.api=null,n.playContainerRef=m.createRef(),n.playContainer=null,n.willReCreatePlayer=!1,n}return p(t,m.Component),u(t,[{key:"componentDidMount",value:function(){this.playContainer=o.findDOMNode(this.playContainerRef.current),this.player=this.playContainer.querySelector("video"),this.createPlayer()}},{key:"componentWillReceiveProps",value:function(e){this.props.file!==e.file&&(this.willReCreatePlayer=!0,this.api=null,this.event=null)}},{key:"componentDidUpdate",value:function(){this.willReCreatePlayer&&(this.willReCreatePlayer=!1,this.createPlayer())}},{key:"componentWillUnmount",value:function(){this.event&&this.event.destroy(),this.api&&this.api.destroy(),this.player=null,this.event=null,this.api=null,this.playContainerRef=null,this.playContainer=null,this.willReCreatePlayer=null,this.flv=null,this.hls=null}},{key:"createPlayer",value:function(){this.initPlayer()&&(this.event=new h(this.player),this.api=new G(this.player,this.playContainer,this.event,this.flv,this.hls),this.props.onInitPlayer&&this.props.onInitPlayer(this.getPlayerApiContext()),this.props.autoPlay&&this.api.play(),this.forceUpdate())}},{key:"render",value:function(){var e=this.props,t=e.autoplay,n=e.poster,r=e.preload,i=void 0===r?"none":r,a=e.muted,o=void 0===a?"muted":a,l=e.className,s=void 0===l?"":l,u=e.loop,c=void 0!==u&&u,d=e.playsinline,p=void 0!==d&&d,h=this.getProvider();return m.createElement("div",{className:"lm-player-container ".concat(s),ref:this.playContainerRef},m.createElement("div",{className:"player-mask-layout"},m.createElement("video",{autoPlay:t,preload:i,muted:o,poster:n,controls:!1,playsInline:p,loop:c})),m.createElement(b,{value:h},this.renderVideoTools()),this.props.children)}}]),t}();te.defaultProps={isLive:!0,isDraggable:!0,isScale:!0,errorReloadTimer:5,muted:"muted",autoPlay:!0,playsInline:!1,preload:"auto",loop:!1};var ne,re=R(J=function(){function t(e){var l;return s(this,t),(l=c(this,d(t).call(this,e))).hideContraller=function(){l.setState({hideBar:!0})},l.showContraller=function(){l.setState({hideBar:!1})},l.reload=function(){var e=l.props.api;l.setState({isEnd:!1,currentTime:e.getCurrentTime()})},l.historyPlayEnd=function(){l.setState({isEnd:!0})},l.getDuration=function(){var e=l.props.api;l.setState({duration:e.getDuration()})},l.getCurrentTime=function(){var e=l.props.api,t={currentTime:e.getCurrentTime(),buffered:e.getSecondsLoaded()};t.buffered===l.state.buffered&&delete t.buffered,l.setState(t)},l.getBuffered=function(){var e=l.props.api;l.setState({buffered:e.getSecondsLoaded()})},l.changePlayTime=function(e){var t=l.props,n=t.seekTo,r=t.historyList,i=r.duration.toString().length,a=(e+i/Math.pow(10,i-1))*r.duration,o=r.fragments.findIndex(function(e){return e.end>a});r.fragments[o].file&&(n(a),l.setState({currentTime:a,isEnd:!1}))},l.seekendPlay=function(){l.props.api.play()},l.renderTimeLineTips=function(e){var t=l.props.historyList,n=e*t.duration*1e3,r=function(e){var t=new Date(e),n=t.getFullYear(),r=t.getDate(),i=t.getMonth()+1,a=t.getHours(),o=t.getMinutes(),l=t.getSeconds();return"".concat(n,".").concat(9<i?i:"0"+i,".").concat(9<r?r:"0"+r," ").concat(9<a?a:"0"+a,".").concat(9<o?o:"0"+o,".").concat(9<l?l:"0"+l)}(t.beginDate+n);return m.createElement("span",null,r)},l.fastForward=function(){l.props.api.fastForward()},l.backWind=function(){l.props.api.backWind()},l.computedLineList=function(e){var t=e.duration;return e.fragments.map(function(e){return{disabled:!e.file,size:(e.end-e.begin)/t*100}})},l.state={duration:1,currentTime:0,buffered:0,isEnd:!1,hideBar:!1},l}return p(t,m.Component),u(t,[{key:"componentDidMount",value:function(){var e=this.props.event;e.addEventListener("loadedmetadata",this.getDuration),e.addEventListener("durationchange",this.getDuration),e.addEventListener("timeupdate",this.getCurrentTime),e.addEventListener("progress",this.getBuffered),e.addEventListener("suspend",this.getBuffered),e.addEventListener("seeked",this.seekendPlay),e.on(H.HISTORY_PLAY_END,this.historyPlayEnd),e.on(H.RELOAD,this.reload),e.on(H.HIDE_CONTRALLER,this.hideContraller),e.on(H.SHOW_CONTRALLER,this.showContraller)}},{key:"componentWillUnmount",value:function(){var e=this.props.event;e.removeEventListener("loadedmetadata",this.getDuration),e.removeEventListener("durationchange",this.getDuration),e.removeEventListener("timeupdate",this.getCurrentTime),e.removeEventListener("progress",this.getBuffered),e.removeEventListener("suspend",this.getBuffered),e.removeEventListener("seeked",this.seekendPlay),e.off(H.HISTORY_PLAY_END,this.historyPlayEnd),e.off(H.RELOAD,this.reload),e.off(H.HIDE_CONTRALLER,this.hideContraller),e.off(H.SHOW_CONTRALLER,this.showContraller)}},{key:"render",value:function(){var e=this.props,t=e.historyList,n=e.playIndex,r=this.state,i=r.currentTime,a=r.buffered,o=r.isEnd,l=r.hideBar,s=this.computedLineList(t),u=s.filter(function(e,t){return t<n}).map(function(e){return e.size}),c=0===u.length?0:1<u.length?u.reduce(function(e,t){return e+t}):u[0],d=i/t.duration*100+c,p=a/t.duration*100+c;return m.createElement("div",{className:"video-time-line-layout ".concat(l?"hide-time-line":"")},m.createElement(S,{type:"lm-player-PrevFast",onClick:this.backWind,className:"time-line-action-item"}),m.createElement(T,{className:"time-line-box",currentPercent:o?"100":d,availablePercent:p,onChange:this.changePlayTime,renderTips:this.renderTimeLineTips},m.createElement(m.Fragment,null,s.map(function(e,n){var t=s.filter(function(e,t){return t<n}).map(function(e){return e.size}),r=0===t.length?0:1<t.length?t.reduce(function(e,t){return e+t}):t[0];return m.createElement("div",{className:"history-time-line-item ".concat(e.disabled?"history-time-line-disabled":""),key:n,style:{width:"".concat(e.size,"%"),left:"".concat(r,"%")}})}))),m.createElement(S,{type:"lm-player-NextFast_Light",onClick:this.fastForward,className:"time-line-action-item"}))}}]),t}())||J,ie=R(ne=function(){function a(){var e,t;s(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=c(this,(e=d(a)).call.apply(e,[this].concat(r)))).endedHandle=function(){var e=t.props.playIndex;t.props.changePlayIndex(e+1)},t}return p(a,m.Component),u(a,[{key:"componentDidMount",value:function(){this.props.event.addEventListener("ended",this.endedHandle,!1)}},{key:"componentWillUnmount",value:function(){this.props.event.removeEventListener("ended",this.endedHandle,!1)}},{key:"render",value:function(){return null}}]),a}())||ne,ae=function(){function t(e){var a;return s(this,t),(a=c(this,d(t).call(this,e))).initPlayer=function(e){var t=a.props.historyList;if(!t||!t.fragments[e]||!t.fragments[e].file)return null;a.flv&&(a.flv.unload(),a.flv.destroy(),a.flv=null),a.hls&&(a.hls.stopLoad(),a.hls.destroy(),a.hls=null);var n=y(t.fragments[e].file);"flv"===n||"flv"===a.props.type?(a.flv=v(a.player,{file:t.fragments[e].file}),a.api&&a.api.updateChunk({flv:a.flv})):"m3u8"===n||"hls"===a.props.type?(a.hls=f(a.player,t.fragments[e].file),a.api&&a.api.updateChunk({hls:a.hls})):a.player.src=t.fragments[e].file,a.playIndex=e,a.forceUpdate()},a.changePlayIndex=function(e){var t=a.props.historyList;return t&&t.fragments[e]?(t.fragments[e].file?a.initPlayer(e):a.changePlayIndex(e+1),a.api&&a.api.play(),a.event&&a.event.emit(H.CHANGE_PLAY_INDEX,e),!0):(a.event&&a.event.emit(H.HISTORY_PLAY_END),!1)},a.getPlayerApiContext=function(){var e=a.api?a.api.getApi():{},t=a.event?{on:a.event.on.bind(a.event),off:a.event.off.bind(a.event),emit:a.event.emit.bind(a.event)}:{},n={seekTo:a.seekTo};return Object.assign({},e,t,n)},a.computedIndexFormTime=function(t){return a.props.historyList.fragments.findIndex(function(e){return e.end>t})},a.seekTo=function(e){var t=a.props.historyList,n=a.computedIndexFormTime(e),r=t.fragments[n];if(r){var i=e-r.begin-1;a.api&&a.api.pause(),n===a.playIndex&&a.api||a.changePlayIndex(n),a.api.seekTo(i,!0),a.event.emit(H.SEEK,e)}},a.reloadHistory=function(){a.changePlayIndex(0),a.api.seekTo(0),a.event.emit(H.RELOAD),a.api.play()},a.getProvider=function(){return{video:a.player,event:a.event,playerProps:a.props,api:a.api,playContainer:a.playContainer,changePlayIndex:a.changePlayIndex,playIndex:a.playIndex,historyList:a.props.historyList,seekTo:a.seekTo,isHistory:!0,reloadHistory:a.reloadHistory}},a.renderVideoTools=function(){return a.api?m.createElement(m.Fragment,null,m.createElement(B,null),m.createElement(q,null),m.createElement(re,null),m.createElement(U,null),m.createElement(X,{flvPlayer:a.flv,hlsPlayer:a.hls}),m.createElement(K,null),m.createElement(ie,null)):m.createElement(w,null)},a.playIndex=0,a.player=null,a.event=null,a.flv=null,a.hls=null,a.playContainerRef=m.createRef(),a.playContainer=null,a.willReCreatePlayer=!1,a}return p(t,m.Component),u(t,[{key:"componentDidMount",value:function(){this.playContainer=o.findDOMNode(this.playContainerRef.current),this.player=this.playContainer.querySelector("video"),this.createPlayer()}},{key:"componentWillReceiveProps",value:function(e){this.props.historyList!==e.historyList&&(this.willReCreatePlayer=!0,this.api=null,this.event=null)}},{key:"componentDidUpdate",value:function(){this.willReCreatePlayer&&(this.playIndex=0,this.willReCreatePlayer=!1,this.createPlayer())}},{key:"componentWillUnmount",value:function(){this.event&&this.event.destroy(),this.api&&this.api.destroy(),this.player=null,this.event=null,this.api=null,this.playContainerRef=null,this.playContainer=null,this.willReCreatePlayer=null,this.flv=null,this.hls=null}},{key:"createPlayer",value:function(){var e=this.props,t=e.defaultTime,n=e.historyList;this.changePlayIndex(this.playIndex)&&(this.event=new h(this.player),this.api=new G(this.player,this.playContainer,this.event,this.flv,this.hls),this.props.onInitPlayer&&this.props.onInitPlayer(this.getPlayerApiContext()),this.props.autoPlay&&this.api.play(),t&&this.seekTo((t-n.beginDate)/1e3))}},{key:"render",value:function(){var e=this.props,t=e.autoplay,n=e.poster,r=e.preload,i=e.muted,a=void 0===i?"muted":i,o=e.loop,l=void 0!==o&&o,s=e.className,u=void 0===s?"":s,c=e.playsinline,d=void 0!==c&&c,p=this.getProvider();return m.createElement("div",{className:"lm-player-container ".concat(u),ref:this.playContainerRef},m.createElement("div",{className:"player-mask-layout"},m.createElement("video",{autoPlay:t,preload:r,muted:a,poster:n,controls:!1,playsInline:d,loop:l})),m.createElement(b,{value:p},this.renderVideoTools()),this.props.children)}}]),t}();ae.defaultProps={isLive:!0,isDraggable:!0,isScale:!0,errorReloadTimer:5,muted:"muted",autoPlay:!0,playsInline:!1,preload:"auto",loop:!1,defaultTime:0},e.Bar=O,e.HistoryPlayer=ae,e.Player=te,e.createHistoryPlayer=function(e){var t=e.container,n=e.children,r=e.onInitPlayer,i=P(e,["container","children","onInitPlayer"]);o.render(m.createElement(ae,Object.assign({},i,{onInitPlayer:function(e){e.destroy=function(){o.unmountComponentAtNode(t)},r&&r(e)}}),n),t)},e.createPlayer=function(e){var t=e.container,n=e.children,r=e.onInitPlayer,i=P(e,["container","children","onInitPlayer"]);o.render(m.createElement(te,Object.assign({},i,{onInitPlayer:function(e){e.destroy=function(){o.unmountComponentAtNode(t)},r&&r(e)}}),n),t)},e.default=te,Object.defineProperty(e,"__esModule",{value:!0})});
