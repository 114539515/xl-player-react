!function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("React"),require("ReactDOM"),require("Hls"),require("flvjs")):"function"===typeof define&&define.amd?define("LMPlayer",["React","ReactDOM","Hls","flvjs"],t):"object"===typeof exports?exports.LMPlayer=t(require("React"),require("ReactDOM"),require("Hls"),require("flvjs")):e.LMPlayer=t(e.React,e.ReactDOM,e.Hls,e.flvjs)}(window,function(e,t,n,i){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(t,n){t.exports=e},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){return(s="function"===typeof Symbol&&"symbol"===o(Symbol.iterator)?function(e){return o(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":o(e)})(e)}function l(e,t){return!t||"object"!==s(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}n.r(t);var d=n(0),f=n.n(d),h=n(9),m=n.n(h),v=function(){function e(t){i(this,e),this.video=t,this.events={}}return a(e,[{key:"on",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this.events[e]?this.events[e].push(t):this.events[e]={type:e,listener:[t]}:void 0!==this.video["on".concat(e)]&&this.video.addEventListener(e,t,!1)}},{key:"emit",value:function(e,t){this.events[e]&&this.events[e].listener.forEach(function(e){e(t)})}},{key:"off",value:function(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&this.events.eventName){var n=this.events[e].listener.findIndex(function(e){return e===t});n>-1&&this.events[e].listener.splice(n,1)}else void 0!==this.video["on".concat(e)]&&this.video.removeEventListener(e,t,!1)}},{key:"destroy",value:function(){this.video=null,this.events=null}}]),e}(),y=n(16),g=n.n(y),b=n(14),k=n.n(b);function E(e,t){var n=new k.a;return n.attachMedia(e),n.on(k.a.Events.MEDIA_ATTACHED,function(){n.loadSource(t),n.on(k.a.Events.MANIFEST_PARSED,function(){})}),n}function P(e,t){if(g.a.isSupported()){var n=g.a.createPlayer({type:"flv",url:t.file,isLive:!!t.isLive},{enableWorker:!1,enableStashBuffer:!1,isLive:!!t.isLive});return n.attachMediaElement(e),n.load(),n}}function C(e){var t=/([^\.\/\\]+)\.(([a-z]|[0-9])+(\?\S+)?)$/i.exec(e);if(t)return t[2].replace(t[4],"")}function D(e){return e&&(document.fullscreenElement===e||document.msFullscreenElement===e||document.mozFullScreenElement===e||document.webkitFullscreenElement===e)||!1}function S(e,t){var n=e?"addEventListener":"removeEventListener";["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"].map(function(e){return document[n](e,t)})}function T(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var L=f.a.createContext(null),w=L.Provider,F=L.Consumer;function x(e){var t=function(t){function n(){return i(this,n),l(this,u(n).apply(this,arguments))}return p(n,f.a.Component),a(n,[{key:"render",value:function(){var t=this.props,n=t.forwardRef,i=T(t,["forwardRef"]);return f.a.createElement(F,null,function(t){return f.a.createElement(e,Object.assign({},i,t,{ref:n}))})}}]),n}();return f.a.forwardRef(function(e,n){return f.a.createElement(t,Object.assign({},e,{forwardRef:n}))})}n(20);function R(e){var t=e.type,n=e.className,i=void 0===n?"":n,r=T(e,["type","className"]);return f.a.createElement("i",Object.assign({className:"lm-player-iconfont ".concat(t," ").concat(i)},r))}n(17);var M,N,O,_,q,I,j,B=function(e){function t(e){var n;return i(this,t),(n=l(this,u(t).call(this,e))).renderSliderTips=function(e){var t=n.props.renderTimeLineTips;if(t){var i=n.layoutDom.getBoundingClientRect(),r=i.x,a=i.width,o=e.pageX-r,s=o/a,l=n.layoutDom.querySelector(".slide-tips");m.a.render(t?t(s):null,l),n.setState({tipsX:o,showTips:!0})}},n.hideSliderTips=function(){n.setState({showTips:!1})},n.cancelPropagation=function(e){e.stopPropagation()},n.startDrag=function(e){e.stopPropagation(),n.dragFlag=!0,document.body.addEventListener("mousemove",n.moveChange),document.body.addEventListener("mouseup",n.stopDrag)},n.moveChange=function(e){e.stopPropagation();var t=n.computedPositionForEvent(e);n.setState({value:t})},n.stopDrag=function(e){e.stopPropagation(),document.body.removeEventListener("mousemove",n.moveChange),document.body.removeEventListener("mouseup",n.stopDrag),n.dragFlag=!1;var t=n.computedPositionForEvent(e);n.props.onChange&&n.props.onChange(t/100)},n.changeCurrentValue=function(e){e.stopPropagation();var t=n.layoutDom.getBoundingClientRect(),i=t.width,r=t.x,a=(e.pageX-r)/i;n.props.onChange&&n.props.onChange(a)},n.sliderDomRef=f.a.createRef(),n.layoutDom=null,n.lineDom=null,n.dragDom=null,n.dragFlag=!1,n.state={value:n.props.currentPercent||0,showTips:!1,tipsX:0},n}return p(t,f.a.Component),a(t,[{key:"componentWillReceiveProps",value:function(e){this.dragFlag||this.setState({value:e.currentPercent||0})}},{key:"componentDidMount",value:function(){this.layoutDom=m.a.findDOMNode(this.sliderDomRef.current),this.dragDom=this.layoutDom.querySelector(".drag-change-icon"),this.lineDom=this.layoutDom.querySelector(".slider-content"),this.layoutDom.addEventListener("mousemove",this.renderSliderTips,!1),this.layoutDom.addEventListener("mouseout",this.hideSliderTips,!1),this.lineDom.addEventListener("click",this.changeCurrentValue,!1),this.dragDom.addEventListener("click",this.cancelPropagation,!1),this.dragDom.addEventListener("mousedown",this.startDrag,!1)}},{key:"componentWillUnmount",value:function(){this.layoutDom.removeEventListener("mousemove",this.renderSliderTips,!1),this.layoutDom.removeEventListener("mouseout",this.hideSliderTips,!1),this.lineDom.removeEventListener("click",this.changeCurrentValue,!1),this.dragDom.removeEventListener("click",this.cancelPropagation,!1),this.dragDom.removeEventListener("mousedown",this.startDrag,!1),document.body.removeEventListener("mousemove",this.moveChange),document.body.removeEventListener("mouseup",this.stopDrag),this.sliderDomRef=null,this.layoutDom=null,this.lineDom=null,this.dragDom=null,this.dragFlag=null}},{key:"computedPositionForEvent",value:function(e){var t=this.layoutDom.getBoundingClientRect(),n=t.x,i=t.width,r=e.pageX-n;return r>i&&(r=i),r<0&&(r=0),r/i*100}},{key:"render",value:function(){var e=this.state,t=e.value,n=e.showTips,i=e.tipsX,r=this.props,a=r.availablePercent,o=void 0===a?0:a,s=r.className,l=void 0===s?"":s;return f.a.createElement("div",{className:"slider-layout ".concat(l),ref:this.sliderDomRef},f.a.createElement("div",{className:"slider-content"},f.a.createElement("div",{className:"slider-max-line"}),f.a.createElement("div",{className:"slider-visibel-line",style:{width:"".concat(o,"%")}}),f.a.createElement("div",{className:"slider-current-line",style:{width:"".concat(t,"%")}}),f.a.createElement("div",{className:"drag-change-icon",draggable:!1,style:{left:"".concat(t,"%")}}),f.a.createElement("div",{style:{left:i,display:n?"block":"none"},className:"slide-tips"}),this.props.children))}}]),t}(),A=x(M=function(e){function t(e){var n;return i(this,t),(n=l(this,u(t).call(this,e))).updateRender=function(){n.forceUpdate()},n.changePlayStatus=function(){var e=n.props,t=e.api;e.video.paused?t.play():t.pause()},n.mutedChange=function(){var e=n.props,t=e.api;e.video.muted?t.unmute():t.mute()},n.volumechange=function(){n.forceUpdate()},n.openSliderVolume=function(){n.setState({openSliderVolume:!0})},n.closeSliderVolume=function(){n.setState({openSliderVolume:!1})},n.onChangeVolume=function(e){var t=n.props,i=t.api,r=t.video;i.setVolume(e),e>0&&r.muted&&i.unmute()},n.state={openSliderVolume:!1},n}return p(t,f.a.Component),a(t,[{key:"componentDidMount",value:function(){this.props.event.on("play",this.updateRender),this.props.event.on("pause",this.updateRender),this.props.event.on("volumechange",this.volumechange)}},{key:"componentWillUnmount",value:function(){this.props.event.off("play",this.updateRender),this.props.event.off("pause",this.updateRender),this.props.event.off("volumechange",this.volumechange)}},{key:"render",value:function(){var e=this.state.openSliderVolume,t=this.props.video,n=1===t.volume?"lm-player-volume-max":"lm-player-volume-normal-fuben";return f.a.createElement("div",{className:"contraller-left-bar"},f.a.createElement("span",{className:"contraller-bar-item"},f.a.createElement(R,{onClick:this.changePlayStatus,type:t.paused?"lm-player-Play_Main":"lm-player-Pause_Main"})),f.a.createElement("span",{className:"contraller-bar-item contraller-bar-volume ".concat(e?"contraller-bar-hover-volume":""),onMouseOver:this.openSliderVolume,onMouseOut:this.closeSliderVolume},f.a.createElement(R,{onClick:this.mutedChange,type:t.muted?"lm-player-volume-close":n}),f.a.createElement("div",{className:"volume-slider-layout"},f.a.createElement(B,{className:"volume-slider",currentPercent:t.muted?0:100*t.volume,onChange:this.onChangeVolume}))),f.a.createElement("span",{className:"contraller-bar-item",onClick:this.changePlayStatus},f.a.createElement(R,{type:t.paused?"lm-player-Play_Main":"lm-player-Pause_Main"})))}}]),t}())||M,V=x(N=function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=l(this,(e=u(t)).call.apply(e,[this].concat(a)))).update=function(){n.forceUpdate()},n.fullscreen=function(){var e=n.props,t=e.api;D(e.playContainer)?t.cancelFullScreen():t.requestFullScreen(),n.forceUpdate()},n}return p(t,f.a.Component),a(t,[{key:"componentDidMount",value:function(){S(!0,this.update)}},{key:"componentWillUnmount",value:function(){S(!1,this.update)}},{key:"render",value:function(){var e=this.props,t=e.api,n=e.playContainer;return f.a.createElement("div",{className:"contraller-right-bar"},f.a.createElement("span",{className:"contraller-bar-item"},f.a.createElement(R,{onClick:function(){return t.setScale(-.2)},type:"lm-player-ZoomOut_Main"})),f.a.createElement("span",{className:"contraller-bar-item"},f.a.createElement(R,{onClick:function(){return t.setScale(1,!0)},type:"lm-player-ZoomDefault_Main"})),f.a.createElement("span",{className:"contraller-bar-item"},f.a.createElement(R,{onClick:function(){return t.setScale(.2)},type:"lm-player-ZoomIn_Main"})),f.a.createElement("span",{className:"contraller-bar-item"},f.a.createElement(R,{onClick:this.fullscreen,type:D(n)?"lm-player-ExitFull_Main":"lm-player-Full_Main"})))}}]),t}())||N,W=(n(21),function(e){function t(){return i(this,t),l(this,u(t).call(this))}return p(t,f.a.Component),a(t,[{key:"render",value:function(){return f.a.createElement("div",{className:"contraller-bar-layout"},f.a.createElement(A,null),f.a.createElement(V,null))}}]),t}()),U=(n(22),x(O=function(e){function t(e){var n;return i(this,t),(n=l(this,u(t).call(this,e))).openLoading=function(){n.setState({loading:!0})},n.closeLoading=function(){n.setState({loading:!1})},n.state={loading:!1},n}return p(t,f.a.Component),a(t,[{key:"componentDidMount",value:function(){var e=this.props.event;e.on("loadstart",this.openLoading),e.on("waiting",this.openLoading),e.on("seeking",this.openLoading),e.on("loadeddata",this.closeLoading),e.on("canplay",this.closeLoading)}},{key:"render",value:function(){var e=this.state.loading;return f.a.createElement("div",{className:"loading-mask ".concat(e?"mask-loading-animation":"")},f.a.createElement(R,{type:"lm-player-Loading",className:"".concat(e?"video-loading-animation":""," video-loading-icon")}))}}]),t}())||O),z=(n(18),x(_=function(e){function t(e){var n;return i(this,t),(n=l(this,u(t).call(this,e))).getDuration=function(){var e=n.props.api;n.setState({duration:e.getDuration()})},n.getCurrentTime=function(){var e=n.props.api,t={currentTime:e.getCurrentTime(),buffered:e.getSecondsLoaded()};t.buffered===n.state.buffered&&delete t.buffered,n.setState(t)},n.getBuffered=function(){var e=n.props.api;n.setState({buffered:e.getSecondsLoaded()})},n.changePlayTime=function(e){var t=n.props,i=t.video,r=t.api,a=e*n.state.duration;i.paused||r.pause(),n.setState({currentTime:a}),r.seekTo(a)},n.seekendPlay=function(){var e=n.props,t=e.video,i=e.api;t.paused&&i.play()},n.renderTimeLineTips=function(e){var t=function(e){var t=Math.ceil(e);if(t>60){var n=Math.ceil(e%60),i=Math.floor(e/60);if(t="".concat(i<10?"0".concat(i):i,":").concat(n<10?"0".concat(n):n),i>60){i=Math.ceil(e/60%60);var r=Math.floor(e/60/60);t="".concat(r<10?"0".concat(r):r,":").concat(i<10?"0".concat(i):i,":").concat(n<10?"0".concat(n):n)}else t="00:".concat(t)}else t="00:00:".concat(t<10?"0".concat(t):t);return t}(e*n.state.duration);return f.a.createElement("span",null,t)},n.fastForward=function(){n.props.api.fastForward()},n.backWind=function(){n.props.api.backWind()},n.state={duration:0,currentTime:0,buffered:0},n}return p(t,f.a.Component),a(t,[{key:"componentDidMount",value:function(){var e=this.props.event;e.on("loadedmetadata",this.getDuration),e.on("durationchange",this.getDuration),e.on("timeupdate",this.getCurrentTime),e.on("progress",this.getBuffered),e.on("suspend",this.getBuffered),e.on("seeked",this.seekendPlay)}},{key:"componentWillUnmount",value:function(){var e=this.props.event;e.off("loadedmetadata",this.getDuration),e.off("durationchange",this.getDuration),e.off("timeupdate",this.getCurrentTime),e.off("progress",this.getBuffered),e.off("suspend",this.getBuffered),e.off("seeked",this.seekendPlay)}},{key:"render",value:function(){var e=this.state,t=e.duration,n=e.currentTime,i=e.buffered,r=Math.round(n/t*100),a=Math.round(i/t*100);return f.a.createElement("div",{className:"video-time-line-layout"},f.a.createElement(R,{type:"lm-player-PrevFast",onClick:this.backWind,className:"time-line-action-item"}),f.a.createElement(B,{className:"time-line-box",currentPercent:r,availablePercent:a,onChange:this.changePlayTime,renderTimeLineTips:this.renderTimeLineTips}),f.a.createElement(R,{type:"lm-player-NextFast_Light",onClick:this.fastForward,className:"time-line-action-item"}))}}]),t}())||_),H=x(q=function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=l(this,(e=u(t)).call.apply(e,[this].concat(a)))).errorHandle=function(e){console.error(e)},n}return p(t,f.a.Component),a(t,[{key:"componentDidMount",value:function(){this.props.event.on("error",this.errorHandle,!1)}},{key:"render",value:function(){return null}}]),t}())||q,X=x(I=function(e){function t(e){var n;i(this,t),(n=l(this,u(t).call(this,e))).openDrag=function(e){n.position.start=[e.pageX,e.pageY],n.dragDom.addEventListener("mousemove",n.moveChange),n.dragDom.addEventListener("mouseup",n.stopDrag)},n.moveChange=function(e){var t=n.props.api,i=t.getPosition();n.position.end=[e.pageX,e.pageY];var r=[i[0]+(n.position.end[0]-n.position.start[0]),i[1]+(n.position.end[1]-n.position.start[1])];t.setPosition(r),n.position.start=[e.pageX,e.pageY]},n.stopDrag=function(){n.dragDom.removeEventListener("mousemove",n.moveChange),n.dragDom.removeEventListener("mouseup",n.stopDrag),n.transformChange()},n.transformChange=function(){var e=n.props.api,t=n.computedBound(n.dragDom,e.getPosition(),e.getScale());t&&e.setPosition(t,!0)};var r=e.playContainer;e.event;return n.dragDom=r.querySelector(".player-mask-layout"),n.position={start:[0,0],end:[0,0]},n}return p(t,f.a.Component),a(t,[{key:"componentDidMount",value:function(){this.dragDom.addEventListener("mousedown",this.openDrag),this.props.event.on("transform",this.transformChange,!0)}},{key:"componentWillUnmount",value:function(){this.dragDom.removeEventListener("mousedown",this.openDrag),this.props.event.off("transform",this.transformChange)}},{key:"computedBound",value:function(e,t,n){var i,r,a=t,o=e.getBoundingClientRect(),s=o.width,l=o.height;if(1===n)return[0,0];i=s*(n-1)/2/n,r=l*(n-1)/2/n;var u=0,c=0;return a[0]>=0&&a[0]>i&&(u=i),a[0]>=0&&a[0]<i&&(u=a[0]),a[0]<0&&a[0]<-i&&(u=-i),a[0]<0&&a[0]>-i&&(u=a[0]),a[1]>=0&&a[1]>r&&(c=r),a[1]>=0&&a[1]<r&&(c=a[1]),a[1]<0&&a[1]<-r&&(c=-r),a[1]<0&&a[1]>-r&&(c=a[1]),u!==a[0]||c!==a[1]?[u,c]:void 0}},{key:"render",value:function(){return null}}]),t}())||I,Y=function(){function e(t,n,r,a,o){i(this,e),this.player=t,this.playContainer=n,this.flv=a,this.hls=o,this.event=r,this.scale=1,this.position=[0,0]}return a(e,[{key:"requestFullScreen",value:function(){var e;D(this.playContainer)||((e=this.playContainer).requestFullScreen?e.requestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen())}},{key:"cancelFullScreen",value:function(){D(this.playContainer)&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())}},{key:"play",value:function(){this.player.paused&&this.player.play()}},{key:"pause",value:function(){this.player.pause()}},{key:"destroy",value:function(){this.player.removeAttribute("src"),this.hls&&(this.hls.stopLoad(),this.hls.destroy()),this.flv&&(this.flv.unload(),this.flv.destroy()),this.player=null,this.flv=null,this.hls=null,this.playContainer=null,this.event=null,this.scale=null,this.position=null}},{key:"seekTo",value:function(e){var t=this.getBufferedTime();this.flv&&t[0]>e&&(this.flv.unload(),this.flv.load()),this.player.currentTime=e}},{key:"setVolume",value:function(e){this.player.volume=e}},{key:"mute",value:function(){this.player.muted=!0}},{key:"unmute",value:function(){this.player.muted=!1}},{key:"requestPictureInPicture",value:function(){this.player.requestPictureInPicture&&document.pictureInPictureElement!==this.player&&this.player.requestPictureInPicture()}},{key:"exitPictureInPicture",value:function(){document.exitPictureInPicture&&document.pictureInPictureElement===this.player&&document.exitPictureInPicture()}},{key:"setPlaybackRate",value:function(e){this.player.playbackRate=e}},{key:"getDuration",value:function(){if(!this.player)return null;var e=this.player,t=e.duration,n=e.seekable;return t===1/0&&n.length>0?n.end(n.length-1):t}},{key:"getCurrentTime",value:function(){return this.player?this.player.currentTime:null}},{key:"getSecondsLoaded",value:function(){return this.getBufferedTime()[1]}},{key:"getBufferedTime",value:function(){if(!this.player)return null;var e=this.player.buffered;if(0===e.length)return[0,0];var t=e.end(e.length-1),n=e.start(e.length-1),i=this.getDuration();return t>i?i:[n,t]}},{key:"fastForward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=this.getDuration(),n=this.getCurrentTime()+e;this.seekTo(n>t-1?t-1:n)}},{key:"backWind",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=this.getCurrentTime()-e;this.seekTo(t<1?1:t)}},{key:"snapshot",value:function(){var e=document.createElement("canvas"),t=e.getContext("2d");return e.width=this.player.videoWidth,e.height=this.player.videoHeight,t.drawImage(this.player,0,0,e.width,e.height),setTimeout(function(){e.remove(),e=null,t=null},200),e.toDataURL()}},{key:"setScale",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.scale+e;n?i=e:(i<1&&(i=1),i>3&&(i=3)),this.scale=i,this.player.style.transition="transform 0.3s",this.__setTransform(),this.event.emit("transform"),setTimeout(function(){t.player.style.transition="unset"},500)}},{key:"getScale",value:function(){return this.scale}},{key:"setPosition",value:function(e,t){this.position=e,this.player.style.transition=t?"transform 0.3s":"unset",this.__setTransform()}},{key:"getPosition",value:function(){return this.position}},{key:"__setTransform",value:function(){this.player.style.transform="scale(".concat(this.scale,") translate(").concat(this.position[0],"px,").concat(this.position[1],"px)")}},{key:"getApi",value:function(){return{play:this.play.bind(this),pause:this.pause.bind(this),seekTo:this.seekTo.bind(this),setVolume:this.setVolume.bind(this),mute:this.mute.bind(this),unmute:this.unmute.bind(this),requestPictureInPicture:this.requestPictureInPicture.bind(this),exitPictureInPicture:this.exitPictureInPicture.bind(this),setPlaybackRate:this.setPlaybackRate.bind(this),destroy:this.destroy.bind(this),getDuration:this.getDuration.bind(this),getCurrentTime:this.getCurrentTime.bind(this),getSecondsLoaded:this.getSecondsLoaded.bind(this),getBufferedTime:this.getBufferedTime.bind(this),fastForward:this.fastForward.bind(this),backWind:this.backWind.bind(this),snapshot:this.snapshot.bind(this),requestFullScreen:this.requestFullScreen.bind(this),cancelFullScreen:this.cancelFullScreen.bind(this),__player:this.player}}}]),e}(),Z=(n(23),function(e){function t(e){var n;return i(this,t),(n=l(this,u(t).call(this,e))).initPlayer=function(){if(!n.props.file)return null;var e=C(n.props.file);"flv"===e||"flv"===n.props.type?n.flv=P(n.player,n.props):"m3u8"===e||"hls"===n.props.type?n.hls=E(n.player,n.props.file):n.player.src=n.props.file},n.renderVideoTools=function(){return n.player?f.a.createElement(f.a.Fragment,null,f.a.createElement(W,null),f.a.createElement(U,null),f.a.createElement(z,null),f.a.createElement(H,null),f.a.createElement(X,null)):null},n.getPlayerApiContext=function(){var e=n.api?n.api.getApi():{},t=n.event?{on:n.event.on.bind(n.event),off:n.event.off.bind(n.event),emit:n.event.emit.bind(n.event)}:{};return Object.assign({},e,t)},n.player=null,n.event=null,n.flv=null,n.hls=null,n.playerType=null,n.playContainerRef=f.a.createRef(),n.playContainer=null,n}return p(t,f.a.Component),a(t,[{key:"componentDidMount",value:function(){this.playContainer=m.a.findDOMNode(this.playContainerRef.current),this.player=this.playContainer.querySelector("video"),this.initPlayer(),this.event=new v(this.player),this.api=new Y(this.player,this.playContainer,this.event,this.flv,this.hls),this.props.playsinline&&(this.player.setAttribute("playsinline",""),this.player.setAttribute("webkit-playsinline",""),this.player.setAttribute("x5-playsinline","")),this.props.autoPlay&&this.api.getApi().play(),this.forceUpdate(),this.props.onInitPlayer&&this.props.onInitPlayer(this.getPlayerApiContext())}},{key:"componentWillUnmount",value:function(){this.event.destroy(),this.api.destroy(),this.player=null,this.event=null,this.flv=null,this.hls=null,this.playerType=null}},{key:"render",value:function(){var e=this.props,t=e.autoPlay,n=e.poster,i={video:this.player,event:this.event,playerType:this.playerType,playerProps:this.props,api:this.api,playContainer:this.playContainer};return f.a.createElement("div",{className:"lm-player-container",ref:this.playContainerRef},f.a.createElement("div",{className:"player-mask-layout"},f.a.createElement("video",{autoPlay:t,muted:!0,poster:n})),f.a.createElement(w,{value:i},this.renderVideoTools()),this.props.children)}}]),t}()),$=x(j=function(e){function t(e){var n;return i(this,t),(n=l(this,u(t).call(this,e))).getDuration=function(){var e=n.props.api;n.setState({duration:e.getDuration()})},n.getCurrentTime=function(){var e=n.props.api,t={currentTime:e.getCurrentTime(),buffered:e.getSecondsLoaded()};t.buffered===n.state.buffered&&delete t.buffered,n.setState(t)},n.getBuffered=function(){var e=n.props.api;n.setState({buffered:e.getSecondsLoaded()})},n.changePlayTime=function(e){var t=n.props,i=t.video,r=t.api,a=t.historyList,o=e*a.duration,s=a.fragments.findIndex(function(e){return e.end>o}),l=a.fragments[s],u=o-l.begin-1;i.paused||r.pause(),l.file&&n.setState({currentTime:o}),n.props.initPlayer(s,!1,u),r.seekTo(u)},n.seekendPlay=function(){var e=n.props,t=e.video,i=e.api;t.paused&&i.play()},n.renderTimeLineTips=function(e){var t=n.props.historyList,i=e*t.duration*1e3,r=function(e){var t=new Date(e),n=t.getFullYear(),i=t.getDate(),r=t.getMonth()+1,a=t.getHours(),o=t.getMinutes(),s=t.getSeconds();return"".concat(n,".").concat(r>10?r:"0"+r,".").concat(i>10?i:"0"+i," ").concat(a>10?a:"0"+a,".").concat(o>10?o:"0"+o,".").concat(s>10?s:"0"+s)}(new Date(t.beginDate).getTime()+i);return f.a.createElement("span",null,r)},n.fastForward=function(){n.props.api.fastForward()},n.backWind=function(){n.props.api.backWind()},n.computedLineList=function(e){var t=e.duration;return e.fragments.map(function(e){return{disabled:!e.file,size:(e.end-e.begin)/t*100}})},n.state={duration:1,currentTime:0,buffered:0},n}return p(t,f.a.Component),a(t,[{key:"componentDidMount",value:function(){var e=this.props.event;e.on("loadedmetadata",this.getDuration),e.on("durationchange",this.getDuration),e.on("timeupdate",this.getCurrentTime),e.on("progress",this.getBuffered),e.on("suspend",this.getBuffered),e.on("seeked",this.seekendPlay)}},{key:"componentWillUnmount",value:function(){var e=this.props.event;e.off("loadedmetadata",this.getDuration),e.off("durationchange",this.getDuration),e.off("timeupdate",this.getCurrentTime),e.off("progress",this.getBuffered),e.off("suspend",this.getBuffered),e.off("seeked",this.seekendPlay)}},{key:"render",value:function(){var e=this.props,t=e.historyList,n=e.playIndex,i=this.state,r=i.currentTime,a=i.buffered,o=this.computedLineList(t),s=o.filter(function(e,t){return t<n}).map(function(e){return e.size}),l=0===s.length?0:s.length>1?s.reduce(function(e,t){return e+t}):s[0],u=Math.round(r/t.duration*100+l),c=Math.round(a/t.duration*100+l);return f.a.createElement("div",{className:"video-time-line-layout"},f.a.createElement(R,{type:"lm-player-PrevFast",onClick:this.backWind,className:"time-line-action-item"}),f.a.createElement(B,{className:"time-line-box",currentPercent:u,availablePercent:c,onChange:this.changePlayTime,renderTimeLineTips:this.renderTimeLineTips},f.a.createElement(f.a.Fragment,null,o.map(function(e,t){var n=o.filter(function(e,n){return n<t}).map(function(e){return e.size}),i=0===n.length?0:n.length>1?n.reduce(function(e,t){return e+t}):n[0];return f.a.createElement("div",{className:"history-time-line-item ".concat(e.disabled?"history-time-line-disabled":""),key:t,style:{width:"".concat(e.size,"%"),left:"".concat(i,"%")}})}))),f.a.createElement(R,{type:"lm-player-NextFast_Light",onClick:this.fastForward,className:"time-line-action-item"}))}}]),t}())||j,G=function(e){function t(e){var n;return i(this,t),(n=l(this,u(t).call(this,e))).checkFirstFile=function(){var e=n.props,t=e.defaultTime,i=e.historyList;i&&(t||(n.playIndex=i.fragments.findIndex(function(e){return!!e.file})))},n.initPlayer=function(e,t){var i=n.props.historyList;if(!i||!i.fragments[e]||!i.fragments[e].file)return null;n.flv&&n.flv.unload(),n.hls&&n.hls.stopLoad();var r=C(i.fragments[e].file);"flv"===r||"flv"===n.props.type?n.flv=P(n.player,n.props):"m3u8"===r||"hls"===n.props.type?n.hls=E(n.player,i.fragments[e].file):n.player.src=i.fragments[e].file,t||(console.log(111111111111),n.playIndex=e,n.forceUpdate())},n.renderVideoTools=function(){var e=n.props.historyList;return n.player?React.createElement(React.Fragment,null,React.createElement(W,null),React.createElement(U,null),React.createElement($,{historyList:e,playIndex:n.playIndex,initPlayer:n.initPlayer}),React.createElement(H,null),React.createElement(X,null)):null},n.playIndex=0,n}return p(t,Z),a(t,[{key:"componentDidMount",value:function(){this.playContainer=ReactDOM.findDOMNode(this.playContainerRef.current),this.player=this.playContainer.querySelector("video"),this.checkFirstFile(),this.initPlayer(this.playIndex,!0),this.event=new v(this.player),this.api=new Y(this.player,this.playContainer,this.event,this.flv,this.hls),this.props.playsinline&&(this.player.setAttribute("playsinline",""),this.player.setAttribute("webkit-playsinline",""),this.player.setAttribute("x5-playsinline","")),this.props.autoPlay&&this.api.getApi().play(),this.forceUpdate(),this.props.onInitPlayer&&this.props.onInitPlayer(this.getPlayerApiContext())}}]),t}();Z.HistoryPlayer=G;t.default=Z},,,,,,,,function(e,n){e.exports=t},,,,,function(e,t){e.exports=n},,function(e,t){e.exports=i},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){}]).default});
//# sourceMappingURL=LMPlayer.js.map