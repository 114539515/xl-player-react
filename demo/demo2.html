<!DOCTYPE HTML>
<html>

<head>
  <title>demo</title>
</head>

<body>
  <video id="videoElement" muted></video>
  <script src="./flv.min.js"></script>
  <script>
    if (flvjs.isSupported()) {
      flvjs.LoggingControl.enableVerbose = false
      var videoElement = document.querySelector('video');
      var flvPlayer = flvjs.createPlayer({
        type: 'flv',
        url: 'http://dgdx-api.antelopecloud.cn/v2/539100188/live.flv?client_token=539100188_0_1556521669_000616d53d4036a7e4a7bcd8e90f62a0',
        isLive: true
      });
      flvPlayer.attachMediaElement(videoElement);
      flvPlayer.load();
      flvPlayer.play();
	  console.log(flvPlayer,flvjs)
      var progressTime = Date.now()
      videoElement.addEventListener('progress', () => {
        progressTime = Date.now()
        if (videoElement.buffered.end(0) - videoElement.currentTime > 5) {
          console.log(`更新播放时间：当前播放时间->${videoElement.currentTime} - 更新播放时间->${videoElement.buffered.end(0) - 2}`)
          videoElement.currentTime = videoElement.buffered.end(0) - 2 // 更新当前时间
        }
      })

      setInterval(() => {
        if (Date.now() - progressTime > 10 * 1000) {
          flvPlayer.unload()
          flvPlayer.load();
          if (videoElement.paused) {
            flvPlayer.play();
          }
        }
      }, 1000 * 10)
    }
  </script>
</body>

</html>